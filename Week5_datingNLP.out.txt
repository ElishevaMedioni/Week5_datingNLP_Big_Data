R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"Copyright (C) 2022 The R Foundation for Statistical ComputingPlatform: aarch64-apple-darwin20 (64-bit)R est un logiciel libre livré sans AUCUNE GARANTIE.Vous pouvez le redistribuer sous certaines conditions.Tapez 'license()' ou 'licence()' pour plus de détails.R est un projet collaboratif avec de nombreux contributeurs.Tapez 'contributors()' pour plus d'information et'citation()' pour la façon de le citer dans les publications.Tapez 'demo()' pour des démonstrations, 'help()' pour l'aideen ligne ou 'help.start()' pour obtenir l'aide au format HTML.Tapez 'q()' pour quitter R.> # load libraries> library(stringr)> library(dplyr)Attachement du package : ‘dplyr’Les objets suivants sont masqués depuis ‘package:stats’:    filter, lagLes objets suivants sont masqués depuis ‘package:base’:    intersect, setdiff, setequal, union> library(ggplot2)> library(mosaic)Registered S3 method overwritten by 'mosaic':  method                           from     fortify.SpatialPolygonsDataFrame ggplot2The 'mosaic' package masks several functions from core packages in order to add additional features.  The original behavior of these functions should not be affected by this.Attachement du package : ‘mosaic’L'objet suivant est masqué depuis ‘package:Matrix’:    meanL'objet suivant est masqué depuis ‘package:ggplot2’:    statLes objets suivants sont masqués depuis ‘package:dplyr’:    count, do, tallyLes objets suivants sont masqués depuis ‘package:stats’:    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test, quantile, sd, t.test, varLes objets suivants sont masqués depuis ‘package:base’:    max, mean, min, prod, range, sample, sum> library(dplyr)> library(stringr)> library(xtable)> library(gridExtra)Attachement du package : ‘gridExtra’L'objet suivant est masqué depuis ‘package:dplyr’:    combine> library(stopwords)> library(quanteda)Package version: 3.2.1Unicode version: 13.0ICU version: 69.1Parallel computing: 8 of 8 threads used.See https://quanteda.io for tutorials and examples.> library(caret)Attachement du package : ‘caret’L'objet suivant est masqué depuis ‘package:mosaic’:    dotPlot> library(rpart)> library(rpart.plot)> library(caTools)> library(recipes)Attachement du package : ‘recipes’L'objet suivant est masqué depuis ‘package:Matrix’:    updateL'objet suivant est masqué depuis ‘package:stringr’:    fixedL'objet suivant est masqué depuis ‘package:stats’:    step> library(ClusterR)Le chargement a nécessité le package : gtoolsAttachement du package : ‘gtools’L'objet suivant est masqué depuis ‘package:mosaic’:    logit> library(cluster)> library(Rtsne)> > # Set rounding to 2 digits> options(digits=2)> > # Load texts (read.csv)> profiles <- read.csv( file.path('/Users/Elish_1/Downloads', 'okcupid_profiles.csv'), header=TRUE, stringsAsFactors=FALSE)> n <- nrow(profiles)> > str(profiles)'data.frame':	59946 obs. of  31 variables: $ age        : int  22 35 38 23 29 29 32 31 24 37 ... $ status     : chr  "single" "single" "available" "single" ... $ sex        : chr  "m" "m" "m" "m" ... $ orientation: chr  "straight" "straight" "straight" "straight" ... $ body_type  : chr  "a little extra" "average" "thin" "thin" ... $ diet       : chr  "strictly anything" "mostly other" "anything" "vegetarian" ... $ drinks     : chr  "socially" "often" "socially" "socially" ... $ drugs      : chr  "never" "sometimes" "" "" ... $ education  : chr  "working on college/university" "working on space camp" "graduated from masters program" "working on college/university" ... $ ethnicity  : chr  "asian, white" "white" "" "white" ... $ height     : num  75 70 68 71 66 67 65 65 67 65 ... $ income     : int  -1 80000 -1 20000 -1 -1 -1 -1 -1 -1 ... $ job        : chr  "transportation" "hospitality / travel" "" "student" ... $ last_online: chr  "2012-06-28-20-30" "2012-06-29-21-41" "2012-06-27-09-10" "2012-06-28-14-22" ... $ location   : chr  "south san francisco, california" "oakland, california" "san francisco, california" "berkeley, california" ... $ offspring  : chr  "doesn't have kids, but might want them" "doesn't have kids, but might want them" "" "doesn't want kids" ... $ pets       : chr  "likes dogs and likes cats" "likes dogs and likes cats" "has cats" "likes cats" ... $ religion   : chr  "agnosticism and very serious about it" "agnosticism but not too serious about it" "" "" ... $ sign       : chr  "gemini" "cancer" "pisces but it doesn&rsquo;t matter" "pisces" ... $ smokes     : chr  "sometimes" "no" "no" "no" ... $ speaks     : chr  "english" "english (fluently), spanish (poorly), french (poorly)" "english, french, c++" "english, german (poorly)" ... $ essay0     : chr  "about me:  i would love to think that i was some some kind of intellectual: either the dumbest smart guy, or th"| __truncated__ "i am a chef: this is what that means. 1. i am a workaholic. 2. i love to cook regardless of whether i am at wor"| __truncated__ "i'm not ashamed of much, but writing public text on an online dating site makes me pleasantly uncomfortable. i'"| __truncated__ "i work in a library and go to school. . ." ... $ essay1     : chr  "currently working as an international agent for a freight forwarding company. import, export, domestic you know"| __truncated__ "dedicating everyday to being an unbelievable badass." "i make nerdy software for musicians, artists, and experimenters to indulge in their own weirdness, but i like t"| __truncated__ "reading things written by old dead people" ... $ essay2     : chr  "making people laugh. ranting about a good salting. finding simplicity in complexity, and complexity in simplicity." "being silly. having ridiculous amonts of fun wherever. being a smart ass. ohh and i can cook. ;)" "improvising in different contexts. alternating between being present and decidedly outside of a moment, or tryi"| __truncated__ "playing synthesizers and organizing books according to the library of congress classification system" ... $ essay3     : chr  "the way i look. i am a six foot half asian, half caucasian mutt. it makes it tough not to notice me, and for me to blend in." "" "my large jaw and large glasses are the physical things people comment on the most. when sufficiently stimulated"| __truncated__ "socially awkward but i do my best" ... $ essay4     : chr  "books: absurdistan, the republic, of mice and men (only book that made me want to cry), catcher in the rye, the"| __truncated__ "i am die hard christopher moore fan. i don't really watch a lot of tv unless there is humor involved. i am kind"| __truncated__ "okay this is where the cultural matrix gets so specific, it's like being in the crosshairs.  for what it's wort"| __truncated__ "bataille, celine, beckett. . . lynch, jarmusch, r.w. fassbender. . . twin peaks & fishing w/ john joy division,"| __truncated__ ... $ essay5     : chr  "food. water. cell phone. shelter." "delicious porkness in all of its glories. my big ass doughboy's sinking into 15 new inches. my overly resilient"| __truncated__ "movement conversation creation contemplation touch humor" "" ... $ essay6     : chr  "duality and humorous things" "" "" "cats and german philosophy" ... $ essay7     : chr  "trying to find someone to hang out with. i am down for anything except a club." "" "viewing. listening. dancing. talking. drinking. performing." "" ... $ essay8     : chr  "i am new to california and looking for someone to wisper my secrets to." "i am very open and will share just about anything." "when i was five years old, i was known as \"the boogerman\"." "" ... $ essay9     : chr  "you want to be swept off your feet! you are tired of the norm. you want to catch a coffee or a bite. or if you "| __truncated__ "" "you are bright, open, intense, silly, ironic, critical, caring, generous, looking for an exploration, rather th"| __truncated__ "you feel so inclined." ...> > essays <- select(profiles, starts_with("essay"))> essays <- apply(essays, MARGIN = 1, FUN = paste, collapse=" ")> > html <- c( "<a[^>]+>", "class=[\"'][^\"']+[\"']", "&[a-z]+;", "\n", "\\n", "<br ?/>", "</[a-z]+ ?>" )> stop.words <-  c( "a", "am", "an", "and", "as", "at", "are", "be", "but", "can", "do", "for", "have", "i'm", "if", "in", "is", "it", "like", "love", "my", "of", "on", "or", "so", "that", "the", "to", "with", "you", "i" )> > html.pat <- paste0( "(", paste(html, collapse = "|"), ")" )> html.pat[1] "(<a[^>]+>|class=[\"'][^\"']+[\"']|&[a-z]+;|\n|\\n|<br ?/>|</[a-z]+ ?>)"> stop.words.pat <- paste0( "\\b(", paste(stop.words, collapse = "|"), ")\\b" )> stop.words.pat[1] "\\b(a|am|an|and|as|at|are|be|but|can|do|for|have|i'm|if|in|is|it|like|love|my|of|on|or|so|that|the|to|with|you|i)\\b"> essays <- str_replace_all(essays, html.pat, " ")> essays <- str_replace_all(essays, stop.words.pat, " ")> > # Clean texts, tokenize, remove stop words (token, tokens_select)> # Tokenize essay texts> all.tokens <- tokens(essays, what = "word",+                      remove_numbers = TRUE, remove_punct = TRUE,+                      remove_symbols = TRUE, remove_hyphens = TRUE)Message d'avis :remove_hyphens argument is not used. > > # Take a look at a specific message and see how it transforms.> all.tokens[[357]]   [1] "swirl"          "words"          "identify"       "harpsichords"   "mid-century"    "furniture"        [7] "color"          "black"          "droste"         "effect"         "matryoshka"     "dolls"           [13] "talk"           "boxes"          "vocoders"       "moment"         "lights"         "dim"             [19] "theater"        "everyone"       "goes"           "silent"         "chess"          "portmanteaus"    [25] "guessing"       "game"           "feeling"        "jubilation"     "after"          "running"         [31] "while"          "drunk"          "friends"        "taxidermy"      "sapere"         "vivere"          [37] "bon"            "vivant"         "ted"            "talks"          "ecstasy"        "clean"           [43] "sheets"         "violin"         "symphony"       "black"          "white"          "tile"            [49] "etherial"       "way"            "words"          "come"           "your"           "consciousness"   [55] "almost"         "out"            "no"             "where"          "nostalgia"      "obfuscated"      [61] "information"    "appears"        "meaningless"    "noise"          "most"           "comprehensible"  [67] "few"            "whom"           "aware"          "basically"      "esotericism"    "pursuit"         [73] "ideals"         "making"         "toasts"         "good"           "friends"        "riddles"         [79] "point"          "which"          "experiencial"   "present"        "turns"          "into"            [85] "past"           "when"           "two"            "mirrors"        "faced"          "parallel"        [91] "each"           "other"          "develop"        "visual"         "feedback"       "loop"            [97] "until"          "everything"     "black"          "attempting"     "less"           "machiavellian"  [103] "they"           "made"           "cologne"        "smelled"        "leather"        "cedar"          [109] "d"              "wear"           "going"          "live"           "forever"        "die"            [115] "trying"         "radio"          "show"           "old"            "school"         "fm"             [121] "not"            "internet"       "work"           "designing"      "gadgets"        "record"         [127] "produce"        "tunes"          "let's"          "collaborate"    "try"            "work"           [133] "some"           "art"            "projects"       "when"           "motivated"      "bought"         [139] "some"           "fencing"        "lessons"        "need"           "use"            "je"             [145] "voudrais"       "apprendre"      "parler"         "franais"        "making"         "mix"            [151] "tapes"          "finding"        "rare"           "music"          "films"          "recording"      [157] "producing"      "music"          "making"         "people"         "laugh"          "storytelling"   [163] "making"         "gifs"           "restraining"    "desire"         "make"           "sardonic"       [169] "comments"       "dancing"        "there's"        "no"             "one"            "there"          [175] "while"          "there's"        "someone"        "there"          "posed"          "this"           [181] "question"       "friends"        "they"           "responded"      "really"         "tall"           [187] "eccentric"      "bright"         "smile"          "d"              "think"          "affability"     [193] "gregariousness" "books"          "nonfiction"     "fooled"         "by"             "randomness"     [199] "taleb"          "black"          "swan"           "taleb"          "nothing"        "movie"          [205] "this"           "your"           "brain"          "music"          "levitin"        "blink"          [211] "gladwell"       "philosophy"     "andy"           "warhol"         "viz"            "pleasures"      [217] "sorrows"        "work"           "de"             "botton"         "fahrenheit"     "bradbury"       [223] "currently"      "reading"        "live"           "from"           "death"          "row"            [229] "mumia"          "abu-jamal"      "films"          "eraserhead"     "lynch"          "irrversible"    [235] "no"             "play"           "time"           "tati"           "space"          "odyssey"        [241] "kubrick"        "they"           "live"           "carpenter"      "videodrome"     "cronenberg"     [247] "phantom"        "paradise"       "de"             "palma"          "tetsuo"         "ironman"        [253] "tsukamoto"      "guerrieri"      "dell'anno"      "fulci"          "food"           "jan"            [259] "svankmajer"     "paris"          "texas"          "wenders"        "documentaries"  "tokyo-ga"       [265] "wenders"        "american"       "movie"          "smith"          "mechanical"     "ambo"           [271] "spin"           "springer"       "goddess"        "bunny"          "aes-nihil"      "solely"         [277] "mind"           "melting"        "outsider"       "aspect"         "dark"           "days"           [283] "singer"         "marwencol"      "hobo"           "davis"          "any"            "frederick"      [289] "wiseman"        "documentary"    "cinma"          "vrit"           "genre"          "giallo"         [295] "films"          "italian"        "sci-fi"         "films"          "from"           "s"              [301] "artists"        "claes"          "oldenburg"      "chris"          "burden"         "marcel"         [307] "duchamp"        "ren"            "magritte"       "marina"         "abramovic"      "jan"            [313] "vankmajer"      "wim"            "delvoye"        "arthur"         "ganson"         "aldo"           [319] "tambellini"     "hajime"         "sorayama"       "jonathan"       "zawada"         "designers"      [325] "joe"            "colombo"        "dieter"         "rams"           "distaste"       "tv"             [331] "watch"          "enjoy"          "downtown"       "no"             "gaki"           "no"             [337] "tsukai"         "ya"             "arahende"       "derren"         "brown"          "nova"           [343] "frontline"      "food"           "quiche"         "sushi"          "nigiri"         "cinnamon"       [349] "rolls"          "french"         "toast"          "duck"           "indian"         "food"           [355] "naan"           "soo"            "good"           "burritos"       "those"          "oreo"           [361] "ice-cream"      "sandwiches"     "crack"          "zante's"        "indian"         "pizza"          [367] "music"          "funk"           "pfunk"          "soul"           "italo"          "freestyle"      [373] "house"          "techno"         "electro"        "classical"      "modern"         "classical"      [379] "pre-90"         "s"              "hip-hop"        "abstract"       "hiphop"         "nu-disco"       [385] "s"              "french"         "pop"            "noise"          "genre"          "right"          [391] "now"            "really"         "digging"        "trippple"       "nippples"       "gigamesh"       [397] "com"            "truise"         "krzysztof"      "penderecki"     "some"           "people"         [403] "collection"     "brothers"       "4th"            "floor"          "live"           "crew"           [409] "unlimited"      "49ers"          "boyz"           "guy"            "called"         "gerald"         [415] "-trak"          "abstract"       "thought"        "adam"           "freeland"       "adamski"        [421] "adonis"         "adult"          "afrika"         "bambaataa"      "air"            "alan"           [427] "braxe"          "alex"           "gopher"         "alphaville"     "anoraak"        "aphex"          [433] "twin"           "arabesque"      "archigram"      "armand"         "van"            "helden"         [439] "arpanet"        "art"            "noise"          "aux"            "bag"            "raiders"        [445] "baltimora"      "bam"            "bam"            "basement"       "jaxx"           "berlin"         [451] "beverly"        "hills"          "binary"         "finary"         "birdy"          "nam"            [457] "nam"            "black"          "devil"          "disco"          "club"           "boards"         [463] "canada"         "bobby"          "orlando"        "bobmo"          "bolz"           "bolz"           [469] "boys"           "noize"          "breakbot"       "brodinski"      "bronski"        "beat"           [475] "bruce"          "haack"          "busy"           "p"              "calvin"         "harris"         [481] "cansei"         "de"             "ser"            "sexy"           "carl"           "carlton"        [487] "cazals"         "chic"           "chicken"        "lips"           "chloe"          "chlo"           [493] "chromeo"        "college"        "company"        "b"              "confetti's"     "console"        [499] "corona"         "crazy"          "gang"           "crookers"       "crystal"        "castles"        [505] "culture"        "beat"           "curses"         "cursor"         "miner"          "curtis"         [511] "mayfield"       "cut"            "chemist"        "cut"            "copy"           "cyberaktif"     [517] "cybotron"       "czr"            "d"              "mob"            "d"              "m"              [523] "daft"           "punk"           "danger"         "das"            "glow"           "data"           [529] "david"          "e"              "sugar"          "decadance"      "devo"           "digitalism"     [535] "dirty"          "south"          "dj"             "assault"        "dj"             "falcon"         [541] "dj"             "funk"           "dj"             "mehdi"          "dj"             "pierre"         [547] "dj"             "shadow"         "doctor's"       "cat"            "does"           "offend"         [553] "yeah"           "donna"          "summer"         "dopplereffekt"  "drexciya"       "dsl"            [559] "duke"           "dumont"         "dynamix"        "ii"             "egyptian"       "lover"          [565] "elecktroids"    "ellen"          "allien"         "etienne"        "de"             "crcy"           [571] "eurythmics"     "fancy"          "farley"         "jackmaster"     "funk"           "fatboy"         [577] "slim"           "feadz"          "felix"          "fox"            "n"              "wolf"           [583] "fred"           "falke"          "freeez"         "g.g"            "tonet"          "gary's"         [589] "gang"           "george"         "clinton"        "giorgio"        "moroder"        "glass"          [595] "domain"         "goblin"         "goldfrapp"      "goose"          "grandmaster"    "flash"          [601] "green"          "velvet"         "haddaway"       "harold"         "faltermeyer"    "hashim"         [607] "health"         "herbie"         "hancock"        "herve"          "high"           "powered"        [613] "boys"           "hithouse"       "hostage"        "hot"            "chip"           "human"          [619] "resource"       "-f"             "-robots"        "information"    "society"        "inner"          [625] "city"           "jackson"        "his"            "computer"       "band"           "jamie"          [631] "principle"      "japanese"       "telecom"        "jeff"           "mills"          "jimmy"          [637] "mcgriff"        "junior"         "parker"         "joakim"         "joe"            "smooth"         [643] "joey"           "beltram"        "john"           "tejada"         "jona"           "jonzun"         [649] "crew"           "josh"           "wink"           "juan"           "atkins"         "jungle"         [655] "brothers"       "junior"         "boys"           "kavinsky"       "kevin"          "saunderson"     [661] "kim"            "klaxons"        "kraftwerk"      "kurtis"         "blow"           "lady"           [667] "b"              "ladytron"       "laserdance"     "le"             "knight"         "club"           [673] "legowelt"       "les"            "petits"         "pilous"         "lfo"            "lifelike"       [679] "lil"            "louis"          "lisa"           "lisa"           "cult"           "jam"            [685] "m.c"            "miker"          "g"              "deejay"         "sven"           "m.c"            [691] "sar"            "real"           "mccoy"          "malcolm"        "mclaren"        "malcom"         [697] "mclaren"        "man"            "parrish"        "mantronix"      "marshall"       "jefferson"      [703] "marvin"         "gaye"           "melle"          "mel"            "metro"          "area"           [709] "miami"          "horror"         "michael"        "jackson"        "midnight"       "juggernauts"    [715] "mike"           "mareen"         "minitel"        "rose"           "miss"           "kittin"         [721] "miss"           "kittin"         "hacker"         "model"          "modeselektor"   "mr"             [727] "flagio"         "mstrkrft"       "muscles"        "new"            "young"          "pony"           [733] "club"           "newcleus"       "noel"           "orchestral"     "manoeuvres"     "dark"           [739] "padded"         "cell"           "pan"            "sonic"          "para"           "one"            [745] "parris"         "mitchell"       "project"        "phuture"        "planet"         "patrol"         [751] "play"           "paul"           "plump"          "djs"            "power"          "supply"         [757] "pretty"         "poison"         "proxy"          "rah"            "band"           "ratatat"        [763] "raymond"        "scott"          "reel"           "real"           "rhythm"         "rhythm"         [769] "richie"         "hawtin"         "riton"          "rjd2"           "rob"            "base"           [775] "dj"             "e-z"            "rock"           "robert"         "hood"           "robin"          [781] "s"              "rockwell"       "roger"          "rondo"          "veneziano"      "s'express"      [787] "salt-n-pepa"    "scatman"        "john"           "scenario"       "rock"           "scotch"         [793] "sebastian"      "sbastien"       "tellier"        "sequencial"     "shadow"         "dancer"         [799] "shannon"        "sheila"         "e"              "silicon"        "teens"          "simian"         [805] "mobile"         "disco"          "sir"            "mix-"           "-lot"           "smackos"        [811] "snap"           "soft"           "cell"           "soulwax"        "soviet"         "steve"          [817] "doesn't"        "drive"          "steve"          "reich"          "stevie"         "b"              [823] "strip"          "steve"          "super"          "mal"            "surkin"         "sweet"          [829] "sensation"      "symbolone"      "tag"            "team"           "technotronic"   "teenage"        [835] "bad"            "girl"           "telex"          "live"           "crew"           "album"          [841] "leaf"           "beatmasters"    "brothers"       "johnson"        "buffalo"        "bunch"          [847] "chemical"       "brothers"       "cover"          "girls"          "cribs"          "fatback"        [853] "band"           "flaming"        "lips"           "hacker"         "human"          "league"         [859] "jets"           "knife"          "outhere"        "brothers"       "outrunners"     "prodigy"        [865] "system"         "whitest"        "boy"            "alive"          "thomas"         "bangalter"      [871] "tiga"           "tka"            "together"       "tomas"          "andersson"      "trans"          [877] "x"              "uffie"          "underground"    "resistance"     "unkle"          "urban"          [883] "cookie"         "collective"     "venga"          "boys"           "vengaboys"      "vitalic"        [889] "we"             "music"          "wendy"          "carlos"         "west"           "street"         [895] "mob"            "whodini"        "woody"          "mcbride"        "yazoo"          "yelle"          [901] "yello"          "yuksek"         "zapp"           "zdar"           "zombie"         "nation"         [907] "zongamin"       "mixhell"        "captain"        "sky"            "andr"           "cymone"         [913] "felix"          "da"             "housecat"       "mike"           "mareen"         "gino"           [919] "soccio"         "keith"          "leblanc"        "gaz"            "nevada"         "sacha"          [925] "di"             "manolo"         "ready"          "world"          "knightlife"     "miami"          [931] "horror"         "kiki"           "kiko"           "automat"        "blowfly"        "seebach"        [937] "band"           "zazu"           "q"              "b.w.h"          "fun"            "fun"            [943] "transvolta"     "proxyon"        "laserdance"     "proxyon"        "klein"          "m.b.o"          [949] "universal"      "energy"         "azoto"          "droids"         "blowfly"        "space"          [955] "space"          "art"            "patrick"        "cowley"         "vc"             "people"         [961] "meco"           "tomas"          "andersson"      "angelo"         "badalamenti"    "david"          [967] "lynch"          "flagranti"      "sacha"          "di"             "manolo"         "venus"          [973] "gang"           "venus"          "gang"           "transvolta"     "transvolta"     "strip"          [979] "steve"          "strip"          "steve"          "space"          "art"            "syntech"        [985] "dirty"          "sanchez"        "siriusmo"       "egyptian"       "lover"          "oliver"         [991] "cheatham"       "oliver"         "cheatham"       "whispers"       "parris"         "mitchell"       [997] "modem"          "sinnamon"       "cellophane"     "los"            [ reached getOption("max.print") -- omitted 452 entries ]> > # Lower case the tokens.> all.tokens <- tokens_tolower(all.tokens)> > # Use quanteda's built-in stopword list for English.> # NOTE - You should always inspect stopword lists for applicability to> #        your problem/domain.> all.tokens <- tokens_select(all.tokens, stopwords(),+                             selection = "remove")> all.tokens[[357]]   [1] "swirl"          "words"          "identify"       "harpsichords"   "mid-century"    "furniture"        [7] "color"          "black"          "droste"         "effect"         "matryoshka"     "dolls"           [13] "talk"           "boxes"          "vocoders"       "moment"         "lights"         "dim"             [19] "theater"        "everyone"       "goes"           "silent"         "chess"          "portmanteaus"    [25] "guessing"       "game"           "feeling"        "jubilation"     "running"        "drunk"           [31] "friends"        "taxidermy"      "sapere"         "vivere"         "bon"            "vivant"          [37] "ted"            "talks"          "ecstasy"        "clean"          "sheets"         "violin"          [43] "symphony"       "black"          "white"          "tile"           "etherial"       "way"             [49] "words"          "come"           "consciousness"  "almost"         "nostalgia"      "obfuscated"      [55] "information"    "appears"        "meaningless"    "noise"          "comprehensible" "aware"           [61] "basically"      "esotericism"    "pursuit"        "ideals"         "making"         "toasts"          [67] "good"           "friends"        "riddles"        "point"          "experiencial"   "present"         [73] "turns"          "past"           "two"            "mirrors"        "faced"          "parallel"        [79] "develop"        "visual"         "feedback"       "loop"           "everything"     "black"           [85] "attempting"     "less"           "machiavellian"  "made"           "cologne"        "smelled"         [91] "leather"        "cedar"          "d"              "wear"           "going"          "live"            [97] "forever"        "die"            "trying"         "radio"          "show"           "old"            [103] "school"         "fm"             "internet"       "work"           "designing"      "gadgets"        [109] "record"         "produce"        "tunes"          "collaborate"    "try"            "work"           [115] "art"            "projects"       "motivated"      "bought"         "fencing"        "lessons"        [121] "need"           "use"            "je"             "voudrais"       "apprendre"      "parler"         [127] "franais"        "making"         "mix"            "tapes"          "finding"        "rare"           [133] "music"          "films"          "recording"      "producing"      "music"          "making"         [139] "people"         "laugh"          "storytelling"   "making"         "gifs"           "restraining"    [145] "desire"         "make"           "sardonic"       "comments"       "dancing"        "one"            [151] "someone"        "posed"          "question"       "friends"        "responded"      "really"         [157] "tall"           "eccentric"      "bright"         "smile"          "d"              "think"          [163] "affability"     "gregariousness" "books"          "nonfiction"     "fooled"         "randomness"     [169] "taleb"          "black"          "swan"           "taleb"          "nothing"        "movie"          [175] "brain"          "music"          "levitin"        "blink"          "gladwell"       "philosophy"     [181] "andy"           "warhol"         "viz"            "pleasures"      "sorrows"        "work"           [187] "de"             "botton"         "fahrenheit"     "bradbury"       "currently"      "reading"        [193] "live"           "death"          "row"            "mumia"          "abu-jamal"      "films"          [199] "eraserhead"     "lynch"          "irrversible"    "play"           "time"           "tati"           [205] "space"          "odyssey"        "kubrick"        "live"           "carpenter"      "videodrome"     [211] "cronenberg"     "phantom"        "paradise"       "de"             "palma"          "tetsuo"         [217] "ironman"        "tsukamoto"      "guerrieri"      "dell'anno"      "fulci"          "food"           [223] "jan"            "svankmajer"     "paris"          "texas"          "wenders"        "documentaries"  [229] "tokyo-ga"       "wenders"        "american"       "movie"          "smith"          "mechanical"     [235] "ambo"           "spin"           "springer"       "goddess"        "bunny"          "aes-nihil"      [241] "solely"         "mind"           "melting"        "outsider"       "aspect"         "dark"           [247] "days"           "singer"         "marwencol"      "hobo"           "davis"          "frederick"      [253] "wiseman"        "documentary"    "cinma"          "vrit"           "genre"          "giallo"         [259] "films"          "italian"        "sci-fi"         "films"          "s"              "artists"        [265] "claes"          "oldenburg"      "chris"          "burden"         "marcel"         "duchamp"        [271] "ren"            "magritte"       "marina"         "abramovic"      "jan"            "vankmajer"      [277] "wim"            "delvoye"        "arthur"         "ganson"         "aldo"           "tambellini"     [283] "hajime"         "sorayama"       "jonathan"       "zawada"         "designers"      "joe"            [289] "colombo"        "dieter"         "rams"           "distaste"       "tv"             "watch"          [295] "enjoy"          "downtown"       "gaki"           "tsukai"         "ya"             "arahende"       [301] "derren"         "brown"          "nova"           "frontline"      "food"           "quiche"         [307] "sushi"          "nigiri"         "cinnamon"       "rolls"          "french"         "toast"          [313] "duck"           "indian"         "food"           "naan"           "soo"            "good"           [319] "burritos"       "oreo"           "ice-cream"      "sandwiches"     "crack"          "zante's"        [325] "indian"         "pizza"          "music"          "funk"           "pfunk"          "soul"           [331] "italo"          "freestyle"      "house"          "techno"         "electro"        "classical"      [337] "modern"         "classical"      "pre-90"         "s"              "hip-hop"        "abstract"       [343] "hiphop"         "nu-disco"       "s"              "french"         "pop"            "noise"          [349] "genre"          "right"          "now"            "really"         "digging"        "trippple"       [355] "nippples"       "gigamesh"       "com"            "truise"         "krzysztof"      "penderecki"     [361] "people"         "collection"     "brothers"       "4th"            "floor"          "live"           [367] "crew"           "unlimited"      "49ers"          "boyz"           "guy"            "called"         [373] "gerald"         "-trak"          "abstract"       "thought"        "adam"           "freeland"       [379] "adamski"        "adonis"         "adult"          "afrika"         "bambaataa"      "air"            [385] "alan"           "braxe"          "alex"           "gopher"         "alphaville"     "anoraak"        [391] "aphex"          "twin"           "arabesque"      "archigram"      "armand"         "van"            [397] "helden"         "arpanet"        "art"            "noise"          "aux"            "bag"            [403] "raiders"        "baltimora"      "bam"            "bam"            "basement"       "jaxx"           [409] "berlin"         "beverly"        "hills"          "binary"         "finary"         "birdy"          [415] "nam"            "nam"            "black"          "devil"          "disco"          "club"           [421] "boards"         "canada"         "bobby"          "orlando"        "bobmo"          "bolz"           [427] "bolz"           "boys"           "noize"          "breakbot"       "brodinski"      "bronski"        [433] "beat"           "bruce"          "haack"          "busy"           "p"              "calvin"         [439] "harris"         "cansei"         "de"             "ser"            "sexy"           "carl"           [445] "carlton"        "cazals"         "chic"           "chicken"        "lips"           "chloe"          [451] "chlo"           "chromeo"        "college"        "company"        "b"              "confetti's"     [457] "console"        "corona"         "crazy"          "gang"           "crookers"       "crystal"        [463] "castles"        "culture"        "beat"           "curses"         "cursor"         "miner"          [469] "curtis"         "mayfield"       "cut"            "chemist"        "cut"            "copy"           [475] "cyberaktif"     "cybotron"       "czr"            "d"              "mob"            "d"              [481] "m"              "daft"           "punk"           "danger"         "das"            "glow"           [487] "data"           "david"          "e"              "sugar"          "decadance"      "devo"           [493] "digitalism"     "dirty"          "south"          "dj"             "assault"        "dj"             [499] "falcon"         "dj"             "funk"           "dj"             "mehdi"          "dj"             [505] "pierre"         "dj"             "shadow"         "doctor's"       "cat"            "offend"         [511] "yeah"           "donna"          "summer"         "dopplereffekt"  "drexciya"       "dsl"            [517] "duke"           "dumont"         "dynamix"        "ii"             "egyptian"       "lover"          [523] "elecktroids"    "ellen"          "allien"         "etienne"        "de"             "crcy"           [529] "eurythmics"     "fancy"          "farley"         "jackmaster"     "funk"           "fatboy"         [535] "slim"           "feadz"          "felix"          "fox"            "n"              "wolf"           [541] "fred"           "falke"          "freeez"         "g.g"            "tonet"          "gary's"         [547] "gang"           "george"         "clinton"        "giorgio"        "moroder"        "glass"          [553] "domain"         "goblin"         "goldfrapp"      "goose"          "grandmaster"    "flash"          [559] "green"          "velvet"         "haddaway"       "harold"         "faltermeyer"    "hashim"         [565] "health"         "herbie"         "hancock"        "herve"          "high"           "powered"        [571] "boys"           "hithouse"       "hostage"        "hot"            "chip"           "human"          [577] "resource"       "-f"             "-robots"        "information"    "society"        "inner"          [583] "city"           "jackson"        "computer"       "band"           "jamie"          "principle"      [589] "japanese"       "telecom"        "jeff"           "mills"          "jimmy"          "mcgriff"        [595] "junior"         "parker"         "joakim"         "joe"            "smooth"         "joey"           [601] "beltram"        "john"           "tejada"         "jona"           "jonzun"         "crew"           [607] "josh"           "wink"           "juan"           "atkins"         "jungle"         "brothers"       [613] "junior"         "boys"           "kavinsky"       "kevin"          "saunderson"     "kim"            [619] "klaxons"        "kraftwerk"      "kurtis"         "blow"           "lady"           "b"              [625] "ladytron"       "laserdance"     "le"             "knight"         "club"           "legowelt"       [631] "les"            "petits"         "pilous"         "lfo"            "lifelike"       "lil"            [637] "louis"          "lisa"           "lisa"           "cult"           "jam"            "m.c"            [643] "miker"          "g"              "deejay"         "sven"           "m.c"            "sar"            [649] "real"           "mccoy"          "malcolm"        "mclaren"        "malcom"         "mclaren"        [655] "man"            "parrish"        "mantronix"      "marshall"       "jefferson"      "marvin"         [661] "gaye"           "melle"          "mel"            "metro"          "area"           "miami"          [667] "horror"         "michael"        "jackson"        "midnight"       "juggernauts"    "mike"           [673] "mareen"         "minitel"        "rose"           "miss"           "kittin"         "miss"           [679] "kittin"         "hacker"         "model"          "modeselektor"   "mr"             "flagio"         [685] "mstrkrft"       "muscles"        "new"            "young"          "pony"           "club"           [691] "newcleus"       "noel"           "orchestral"     "manoeuvres"     "dark"           "padded"         [697] "cell"           "pan"            "sonic"          "para"           "one"            "parris"         [703] "mitchell"       "project"        "phuture"        "planet"         "patrol"         "play"           [709] "paul"           "plump"          "djs"            "power"          "supply"         "pretty"         [715] "poison"         "proxy"          "rah"            "band"           "ratatat"        "raymond"        [721] "scott"          "reel"           "real"           "rhythm"         "rhythm"         "richie"         [727] "hawtin"         "riton"          "rjd2"           "rob"            "base"           "dj"             [733] "e-z"            "rock"           "robert"         "hood"           "robin"          "s"              [739] "rockwell"       "roger"          "rondo"          "veneziano"      "s'express"      "salt-n-pepa"    [745] "scatman"        "john"           "scenario"       "rock"           "scotch"         "sebastian"      [751] "sbastien"       "tellier"        "sequencial"     "shadow"         "dancer"         "shannon"        [757] "sheila"         "e"              "silicon"        "teens"          "simian"         "mobile"         [763] "disco"          "sir"            "mix-"           "-lot"           "smackos"        "snap"           [769] "soft"           "cell"           "soulwax"        "soviet"         "steve"          "drive"          [775] "steve"          "reich"          "stevie"         "b"              "strip"          "steve"          [781] "super"          "mal"            "surkin"         "sweet"          "sensation"      "symbolone"      [787] "tag"            "team"           "technotronic"   "teenage"        "bad"            "girl"           [793] "telex"          "live"           "crew"           "album"          "leaf"           "beatmasters"    [799] "brothers"       "johnson"        "buffalo"        "bunch"          "chemical"       "brothers"       [805] "cover"          "girls"          "cribs"          "fatback"        "band"           "flaming"        [811] "lips"           "hacker"         "human"          "league"         "jets"           "knife"          [817] "outhere"        "brothers"       "outrunners"     "prodigy"        "system"         "whitest"        [823] "boy"            "alive"          "thomas"         "bangalter"      "tiga"           "tka"            [829] "together"       "tomas"          "andersson"      "trans"          "x"              "uffie"          [835] "underground"    "resistance"     "unkle"          "urban"          "cookie"         "collective"     [841] "venga"          "boys"           "vengaboys"      "vitalic"        "music"          "wendy"          [847] "carlos"         "west"           "street"         "mob"            "whodini"        "woody"          [853] "mcbride"        "yazoo"          "yelle"          "yello"          "yuksek"         "zapp"           [859] "zdar"           "zombie"         "nation"         "zongamin"       "mixhell"        "captain"        [865] "sky"            "andr"           "cymone"         "felix"          "da"             "housecat"       [871] "mike"           "mareen"         "gino"           "soccio"         "keith"          "leblanc"        [877] "gaz"            "nevada"         "sacha"          "di"             "manolo"         "ready"          [883] "world"          "knightlife"     "miami"          "horror"         "kiki"           "kiko"           [889] "automat"        "blowfly"        "seebach"        "band"           "zazu"           "q"              [895] "b.w.h"          "fun"            "fun"            "transvolta"     "proxyon"        "laserdance"     [901] "proxyon"        "klein"          "m.b.o"          "universal"      "energy"         "azoto"          [907] "droids"         "blowfly"        "space"          "space"          "art"            "patrick"        [913] "cowley"         "vc"             "people"         "meco"           "tomas"          "andersson"      [919] "angelo"         "badalamenti"    "david"          "lynch"          "flagranti"      "sacha"          [925] "di"             "manolo"         "venus"          "gang"           "venus"          "gang"           [931] "transvolta"     "transvolta"     "strip"          "steve"          "strip"          "steve"          [937] "space"          "art"            "syntech"        "dirty"          "sanchez"        "siriusmo"       [943] "egyptian"       "lover"          "oliver"         "cheatham"       "oliver"         "cheatham"       [949] "whispers"       "parris"         "mitchell"       "modem"          "sinnamon"       "cellophane"     [955] "los"            "angeles"        "t.f"            "lectric"        "workers"        "lectric"        [961] "workers"        "isley"          "brothers"       "motown"         "sounds"         "peter"          [967] "richard"        "de"             "blanc"          "ris"            "los"            "angeles"        [973] "t.f"            "hypnolove"      "los"            "angeles"        "t.f"            "mark"           [979] "shreeve"        "hypothetical"   "prophets"       "lio"            "jacno"          "space"          [985] "art"            "mixmaster"      "gee"            "turntable"      "orchestra"      "ultramagnetic"  [991] "mc's"           "maskio"         "john"           "foxx"           "vince"          "clarke"         [997] "otis"           "clay"           "peter"          "jacques"        [ reached getOption("max.print") -- omitted 382 entries ]> > > # Perform stemming on the tokens.> all.tokens <- tokens_wordstem(all.tokens, language = "english")> # remove single-word tokens after stemming. Meaningless> all.tokens <- tokens_select(all.tokens, "^[a-z]$",+                             selection = "remove", valuetype = "regex")> all.tokens[[357]]   [1] "swirl"         "word"          "identifi"      "harpsichord"   "mid-centuri"   "furnitur"      "color"           [8] "black"         "drost"         "effect"        "matryoshka"    "doll"          "talk"          "box"            [15] "vocod"         "moment"        "light"         "dim"           "theater"       "everyon"       "goe"            [22] "silent"        "chess"         "portmanteaus"  "guess"         "game"          "feel"          "jubil"          [29] "run"           "drunk"         "friend"        "taxidermi"     "saper"         "viver"         "bon"            [36] "vivant"        "ted"           "talk"          "ecstasi"       "clean"         "sheet"         "violin"         [43] "symphoni"      "black"         "white"         "tile"          "etheri"        "way"           "word"           [50] "come"          "conscious"     "almost"        "nostalgia"     "obfusc"        "inform"        "appear"         [57] "meaningless"   "nois"          "comprehens"    "awar"          "basic"         "esoteric"      "pursuit"        [64] "ideal"         "make"          "toast"         "good"          "friend"        "riddl"         "point"          [71] "experienci"    "present"       "turn"          "past"          "two"           "mirror"        "face"           [78] "parallel"      "develop"       "visual"        "feedback"      "loop"          "everyth"       "black"          [85] "attempt"       "less"          "machiavellian" "made"          "cologn"        "smell"         "leather"        [92] "cedar"         "wear"          "go"            "live"          "forev"         "die"           "tri"            [99] "radio"         "show"          "old"           "school"        "fm"            "internet"      "work"          [106] "design"        "gadget"        "record"        "produc"        "tune"          "collabor"      "tri"           [113] "work"          "art"           "project"       "motiv"         "bought"        "fenc"          "lesson"        [120] "need"          "use"           "je"            "voudrai"       "apprendr"      "parler"        "franai"        [127] "make"          "mix"           "tape"          "find"          "rare"          "music"         "film"          [134] "record"        "produc"        "music"         "make"          "peopl"         "laugh"         "storytel"      [141] "make"          "gif"           "restrain"      "desir"         "make"          "sardon"        "comment"       [148] "danc"          "one"           "someon"        "pose"          "question"      "friend"        "respond"       [155] "realli"        "tall"          "eccentr"       "bright"        "smile"         "think"         "affabl"        [162] "gregari"       "book"          "nonfict"       "fool"          "random"        "taleb"         "black"         [169] "swan"          "taleb"         "noth"          "movi"          "brain"         "music"         "levitin"       [176] "blink"         "gladwel"       "philosophi"    "andi"          "warhol"        "viz"           "pleasur"       [183] "sorrow"        "work"          "de"            "botton"        "fahrenheit"    "bradburi"      "current"       [190] "read"          "live"          "death"         "row"           "mumia"         "abu-jam"       "film"          [197] "eraserhead"    "lynch"         "irrvers"       "play"          "time"          "tati"          "space"         [204] "odyssey"       "kubrick"       "live"          "carpent"       "videodrom"     "cronenberg"    "phantom"       [211] "paradis"       "de"            "palma"         "tetsuo"        "ironman"       "tsukamoto"     "guerrieri"     [218] "dell'anno"     "fulci"         "food"          "jan"           "svankmaj"      "pari"          "texa"          [225] "wender"        "documentari"   "tokyo-ga"      "wender"        "american"      "movi"          "smith"         [232] "mechan"        "ambo"          "spin"          "springer"      "goddess"       "bunni"         "aes-nihil"     [239] "sole"          "mind"          "melt"          "outsid"        "aspect"        "dark"          "day"           [246] "singer"        "marwencol"     "hobo"          "davi"          "frederick"     "wiseman"       "documentari"   [253] "cinma"         "vrit"          "genr"          "giallo"        "film"          "italian"       "sci-fi"        [260] "film"          "artist"        "clae"          "oldenburg"     "chris"         "burden"        "marcel"        [267] "duchamp"       "ren"           "magritt"       "marina"        "abramov"       "jan"           "vankmaj"       [274] "wim"           "delvoy"        "arthur"        "ganson"        "aldo"          "tambellini"    "hajim"         [281] "sorayama"      "jonathan"      "zawada"        "design"        "joe"           "colombo"       "dieter"        [288] "ram"           "distast"       "tv"            "watch"         "enjoy"         "downtown"      "gaki"          [295] "tsukai"        "ya"            "arahend"       "derren"        "brown"         "nova"          "frontlin"      [302] "food"          "quich"         "sushi"         "nigiri"        "cinnamon"      "roll"          "french"        [309] "toast"         "duck"          "indian"        "food"          "naan"          "soo"           "good"          [316] "burrito"       "oreo"          "ice-cream"     "sandwich"      "crack"         "zant"          "indian"        [323] "pizza"         "music"         "funk"          "pfunk"         "soul"          "italo"         "freestyl"      [330] "hous"          "techno"        "electro"       "classic"       "modern"        "classic"       "pre-90"        [337] "hip-hop"       "abstract"      "hiphop"        "nu-disco"      "french"        "pop"           "nois"          [344] "genr"          "right"         "now"           "realli"        "dig"           "tripppl"       "nipppl"        [351] "gigamesh"      "com"           "truis"         "krzysztof"     "penderecki"    "peopl"         "collect"       [358] "brother"       "4th"           "floor"         "live"          "crew"          "unlimit"       "49er"          [365] "boyz"          "guy"           "call"          "gerald"        "-trak"         "abstract"      "thought"       [372] "adam"          "freeland"      "adamski"       "adoni"         "adult"         "afrika"        "bambaataa"     [379] "air"           "alan"          "brax"          "alex"          "gopher"        "alphavill"     "anoraak"       [386] "aphex"         "twin"          "arabesqu"      "archigram"     "armand"        "van"           "helden"        [393] "arpanet"       "art"           "nois"          "aux"           "bag"           "raider"        "baltimora"     [400] "bam"           "bam"           "basement"      "jaxx"          "berlin"        "bever"         "hill"          [407] "binari"        "finari"        "birdi"         "nam"           "nam"           "black"         "devil"         [414] "disco"         "club"          "board"         "canada"        "bobbi"         "orlando"       "bobmo"         [421] "bolz"          "bolz"          "boy"           "noiz"          "breakbot"      "brodinski"     "bronski"       [428] "beat"          "bruce"         "haack"         "busi"          "calvin"        "harri"         "cansei"        [435] "de"            "ser"           "sexi"          "carl"          "carlton"       "cazal"         "chic"          [442] "chicken"       "lip"           "chloe"         "chlo"          "chromeo"       "colleg"        "compani"       [449] "confetti"      "consol"        "corona"        "crazi"         "gang"          "crooker"       "crystal"       [456] "castl"         "cultur"        "beat"          "curs"          "cursor"        "miner"         "curti"         [463] "mayfield"      "cut"           "chemist"       "cut"           "copi"          "cyberaktif"    "cybotron"      [470] "czr"           "mob"           "daft"          "punk"          "danger"        "das"           "glow"          [477] "data"          "david"         "sugar"         "decad"         "devo"          "digit"         "dirti"         [484] "south"         "dj"            "assault"       "dj"            "falcon"        "dj"            "funk"          [491] "dj"            "mehdi"         "dj"            "pierr"         "dj"            "shadow"        "doctor"        [498] "cat"           "offend"        "yeah"          "donna"         "summer"        "dopplereffekt" "drexciya"      [505] "dsl"           "duke"          "dumont"        "dynamix"       "ii"            "egyptian"      "lover"         [512] "elecktroid"    "ellen"         "allien"        "etienn"        "de"            "crci"          "eurythm"       [519] "fanci"         "farley"        "jackmast"      "funk"          "fatboy"        "slim"          "feadz"         [526] "felix"         "fox"           "wolf"          "fred"          "falk"          "freeez"        "g.g"           [533] "tonet"         "gari"          "gang"          "georg"         "clinton"       "giorgio"       "morod"         [540] "glass"         "domain"        "goblin"        "goldfrapp"     "goos"          "grandmast"     "flash"         [547] "green"         "velvet"        "haddaway"      "harold"        "faltermey"     "hashim"        "health"        [554] "herbi"         "hancock"       "herv"          "high"          "power"         "boy"           "hithous"       [561] "hostag"        "hot"           "chip"          "human"         "resourc"       "-f"            "-robot"        [568] "inform"        "societi"       "inner"         "citi"          "jackson"       "comput"        "band"          [575] "jami"          "principl"      "japanes"       "telecom"       "jeff"          "mill"          "jimmi"         [582] "mcgriff"       "junior"        "parker"        "joakim"        "joe"           "smooth"        "joey"          [589] "beltram"       "john"          "tejada"        "jona"          "jonzun"        "crew"          "josh"          [596] "wink"          "juan"          "atkin"         "jungl"         "brother"       "junior"        "boy"           [603] "kavinski"      "kevin"         "saunderson"    "kim"           "klaxon"        "kraftwerk"     "kurti"         [610] "blow"          "ladi"          "ladytron"      "laserd"        "le"            "knight"        "club"          [617] "legowelt"      "les"           "petit"         "pilous"        "lfo"           "lifelik"       "lil"           [624] "loui"          "lisa"          "lisa"          "cult"          "jam"           "m.c"           "miker"         [631] "deejay"        "sven"          "m.c"           "sar"           "real"          "mccoy"         "malcolm"       [638] "mclaren"       "malcom"        "mclaren"       "man"           "parrish"       "mantronix"     "marshal"       [645] "jefferson"     "marvin"        "gay"           "mell"          "mel"           "metro"         "area"          [652] "miami"         "horror"        "michael"       "jackson"       "midnight"      "juggernaut"    "mike"          [659] "mareen"        "minitel"       "rose"          "miss"          "kittin"        "miss"          "kittin"        [666] "hacker"        "model"         "modeselektor"  "mr"            "flagio"        "mstrkrft"      "muscl"         [673] "new"           "young"         "poni"          "club"          "newcleus"      "noel"          "orchestr"      [680] "manoeuvr"      "dark"          "pad"           "cell"          "pan"           "sonic"         "para"          [687] "one"           "parri"         "mitchel"       "project"       "phutur"        "planet"        "patrol"        [694] "play"          "paul"          "plump"         "djs"           "power"         "suppli"        "pretti"        [701] "poison"        "proxi"         "rah"           "band"          "ratatat"       "raymond"       "scott"         [708] "reel"          "real"          "rhythm"        "rhythm"        "richi"         "hawtin"        "riton"         [715] "rjd2"          "rob"           "base"          "dj"            "e-z"           "rock"          "robert"        [722] "hood"          "robin"         "rockwel"       "roger"         "rondo"         "veneziano"     "s'express"     [729] "salt-n-pepa"   "scatman"       "john"          "scenario"      "rock"          "scotch"        "sebastian"     [736] "sbastien"      "tellier"       "sequenci"      "shadow"        "dancer"        "shannon"       "sheila"        [743] "silicon"       "teen"          "simian"        "mobil"         "disco"         "sir"           "mix-"          [750] "-lot"          "smacko"        "snap"          "soft"          "cell"          "soulwax"       "soviet"        [757] "steve"         "drive"         "steve"         "reich"         "stevi"         "strip"         "steve"         [764] "super"         "mal"           "surkin"        "sweet"         "sensat"        "symbolon"      "tag"           [771] "team"          "technotron"    "teenag"        "bad"           "girl"          "telex"         "live"          [778] "crew"          "album"         "leaf"          "beatmast"      "brother"       "johnson"       "buffalo"       [785] "bunch"         "chemic"        "brother"       "cover"         "girl"          "crib"          "fatback"       [792] "band"          "flame"         "lip"           "hacker"        "human"         "leagu"         "jet"           [799] "knife"         "outher"        "brother"       "outrunn"       "prodigi"       "system"        "whitest"       [806] "boy"           "aliv"          "thoma"         "bangalt"       "tiga"          "tka"           "togeth"        [813] "toma"          "andersson"     "tran"          "uffi"          "underground"   "resist"        "unkl"          [820] "urban"         "cooki"         "collect"       "venga"         "boy"           "vengaboy"      "vital"         [827] "music"         "wendi"         "carlo"         "west"          "street"        "mob"           "whodini"       [834] "woodi"         "mcbride"       "yazoo"         "yell"          "yello"         "yuksek"        "zapp"          [841] "zdar"          "zombi"         "nation"        "zongamin"      "mixhel"        "captain"       "sky"           [848] "andr"          "cymon"         "felix"         "da"            "housecat"      "mike"          "mareen"        [855] "gino"          "soccio"        "keith"         "leblanc"       "gaz"           "nevada"        "sacha"         [862] "di"            "manolo"        "readi"         "world"         "knightlif"     "miami"         "horror"        [869] "kiki"          "kiko"          "automat"       "blowfli"       "seebach"       "band"          "zazu"          [876] "b.w.h"         "fun"           "fun"           "transvolta"    "proxyon"       "laserd"        "proxyon"       [883] "klein"         "m.b.o"         "univers"       "energi"        "azoto"         "droid"         "blowfli"       [890] "space"         "space"         "art"           "patrick"       "cowley"        "vc"            "peopl"         [897] "meco"          "toma"          "andersson"     "angelo"        "badalamenti"   "david"         "lynch"         [904] "flagranti"     "sacha"         "di"            "manolo"        "venus"         "gang"          "venus"         [911] "gang"          "transvolta"    "transvolta"    "strip"         "steve"         "strip"         "steve"         [918] "space"         "art"           "syntech"       "dirti"         "sanchez"       "siriusmo"      "egyptian"      [925] "lover"         "oliv"          "cheatham"      "oliv"          "cheatham"      "whisper"       "parri"         [932] "mitchel"       "modem"         "sinnamon"      "cellophan"     "los"           "angel"         "t.f"           [939] "lectric"       "worker"        "lectric"       "worker"        "isley"         "brother"       "motown"        [946] "sound"         "peter"         "richard"       "de"            "blanc"         "ris"           "los"           [953] "angel"         "t.f"           "hypnolov"      "los"           "angel"         "t.f"           "mark"          [960] "shreev"        "hypothet"      "prophet"       "lio"           "jacno"         "space"         "art"           [967] "mixmast"       "gee"           "turntabl"      "orchestra"     "ultramagnet"   "mc"            "maskio"        [974] "john"          "foxx"          "vinc"          "clark"         "oti"           "clay"          "peter"         [981] "jacqu"         "band"          "alter"         "ego"           "alter"         "ego"           "walter"        [988] "murphi"        "stelvio"       "cipriani"      "modern"        "siriusmo"      "grafton"       "primari"       [995] "dramat"        "jacki"         "wilson"        "captain"       "rock"          "captain"       [ reached getOption("max.print") -- omitted 357 entries ]> > # DFM (dfm)> # Create a bag-of-words model (document-term frequency matrix)> all.tokens.dfm <- dfm(all.tokens, tolower = FALSE)> > # clear some space> rm(all.tokens)> > all.tokens.dfmDocument-feature matrix of: 59,946 documents, 153,385 features (99.90% sparse) and 0 docvars.       featuresdocs    think kind intellectu either dumbest smart guy smartest dumb say  text1     1    1          1      1       1     1   2        1    1   1  text2     0    1          0      0       0     1   1        0    0   0  text3     1    1          1      0       0     0   0        0    0   1  text4     0    0          0      0       0     0   0        0    0   0  text5     0    0          0      0       0     0   0        0    0   0  text6     4    0          0      0       0     0   0        0    0   2[ reached max_ndoc ... 59,940 more documents, reached max_nfeat ... 153,375 more features ]> > sparsity(all.tokens.dfm)[1] 1> # meaning that 99.90% of the cells are zeros. Even if you could> # create the data frame, fitting a model is not going to work> # because of this extreme lack of information in the features.> # Solution? Trim some features.> > dfm.trimmed <- dfm_trim(all.tokens.dfm, min_docfreq = 25, min_termfreq = 35, verbose = TRUE)Removing features occurring:   - fewer than 35 times: 140,498  - in fewer than 25 documents: 138,456  Total features removed: 140,528 (91.6%).> dfm.trimmedDocument-feature matrix of: 59,946 documents, 12,857 features (98.86% sparse) and 0 docvars.       featuresdocs    think kind intellectu either smart guy smartest dumb say tell  text1     1    1          1      1     1   2        1    1   1    1  text2     0    1          0      0     1   1        0    0   0    0  text3     1    1          1      0     0   0        0    0   1    0  text4     0    0          0      0     0   0        0    0   0    0  text5     0    0          0      0     0   0        0    0   0    0  text6     4    0          0      0     0   0        0    0   2    0[ reached max_ndoc ... 59,940 more documents, reached max_nfeat ... 12,847 more features ]> > > # Transform to a matrix and inspect.> all.tokens.matrix <- as.matrix(dfm.trimmed)> object.size(all.tokens.matrix)6170958464 bytes> #View(all.tokens.matrix[1:20, 1:100])> dim(all.tokens.matrix)[1] 59946 12857> > > # Investigate the effects of stemming.> # [A]> colnames(all.tokens.matrix)[1:50] [1] "think"      "kind"       "intellectu" "either"     "smart"      "guy"        "smartest"   "dumb"       "say"       [10] "tell"       "differ"     "talk"       "idea"       "concept"    "forg"       "odd"        "metaphor"   "instead"   [19] "recit"      "clich"      "friend"     "mine"       "hous"       "underwat"   "salt"       "favorit"    "word"      [28] "way"        "weird"      "choic"      "know"       "thing"      "life"       "better"     "seek"       "make"      [37] "littl"      "everyday"   "product"    "lazi"       "got"        "tire"       "tie"        "shoe"       "consid"    [46] "hire"       "five"       "year"       "old"        "probabl"   > > # [B]> sort(colnames(all.tokens.matrix))[1:100]  [1] "__"        "___"       "____"      "_____"     "_______"   "-_-"       "-all"      "-all-trad" "-anyth"    [10] "-art"      "-be"       "-between"  "-book"     "-call"     "-coffe"    "-comput"   "-cook"     "-crime"    [19] "-d"        "-danc"     "-day"      "-depth"    "-drink"    "-earth"    "-eat"      "-enjoy"    "-face"     [28] "-famili"   "-find"     "-food"     "-friend"   "-get"      "-give"     "-go"       "-good"     "-gooder"   [37] "-great"    "-hate"     "-have"     "-heart"    "-home"     "-hous"     "-how"      "-humor"    "-internet" [46] "-iphon"    "-know"     "-laugh"    "-laughter" "-law"      "-learn"    "-life"     "-line"     "-listen"   [55] "-live"     "-long"     "-look"     "-make"     "-me"       "-mind"     "-movi"     "-music"    "-n-out"    [64] "-not"      "-one"      "-out"      "-p"        "-peopl"    "-person"   "-phone"    "-play"     "-pod"      [73] "-progress" "-read"     "-risk"     "-run"      "-sex"      "-sleep"    "-some"     "-sport"    "-stay"     [82] "-take"     "-talk"     "-time"     "-top"      "-travel"   "-tri"      "-wall"     "-want"     "-watch"    [91] "-water"    "-way"      "-what"     "-when"     "-where"    "-whi"      "-work"     "-world"    "-write"   [100] "-your"    > > > # Setup a the feature data frame with labels.> all.tokens.df <- cbind(Label = profiles$sex, data.frame(dfm.trimmed))Message d'avis :'as.data.frame.dfm' est obsolète.Utilisez plutôt ‘convert(x, to = "data.frame")’.Voir help("Deprecated") > > > # Often, tokenization requires some additional pre-processing> names(all.tokens.df)[c(146, 148, 235, 238)][1] "throne" "python" "pretti" "though"> > > # Cleanup column names.> names(all.tokens.df) <-make.names(names(all.tokens.df))> > # Use caret to create a 70%/30% stratified split. Set the random> # seed for reproducibility.> set.seed(32984)> indexes <- createDataPartition(all.tokens.df$Label, times = 1,+                                p = 0.7, list = FALSE)> > train <- all.tokens.df[indexes,]> test <- all.tokens.df[-indexes,]> > # remove not numeric feature> train <- subset( train, select = -c(doc_id))> test <- subset( test, select = -c(doc_id))> > object.size(train)4318214560 bytes> object.size(test)1851439920 bytes> > # Verify proportions.> prop.table(table(train$Label))  f   m 0.4 0.6 > prop.table(table(test$Label))  f   m 0.4 0.6 > > > # Use caret to create stratified folds for 10-fold cross validation repeated> # 3 times (i.e., create 30 random stratified samples)> set.seed(48743)> cv.folds <-createMultiFolds(labels, k = 10, times = 3)> > cv.cntrl <-trainControl(+   method = "repeatedcv",+   number = 10,+   repeats = 3,+   index = cv.folds+ )> > # clear some space before the train> gc()          used  (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)Ncells 3.6e+06   194    6.6e+06   353         NA  5.1e+06   271Vcells 2.4e+09 18145    4.0e+09 30551      1e+05  3.3e+09 25459> rm(dfm.trimmed)> rm(cv.folds)> rm(all.tokens.dfm)> > # Time the code execution> start.time <- Sys.time()> > #train a decision tree model> tree <- rpart(Label~., data=train, cp=.02)> total.time <- Sys.time() - start.time> total.timeTime difference of 30 mins> > # print the tree> treen= 41963 node), split, n, loss, yval, (yprob)      * denotes terminal node 1) root 41963 17000 m (0.40 0.60)     2) guy< 0.5 32554 14000 m (0.45 0.55)       4) girl>=0.5 5602  2100 f (0.63 0.37) *     5) girl< 0.5 26952 11000 m (0.41 0.59)        10) danc>=0.5 5931  2700 f (0.54 0.46) *      11) danc< 0.5 21021  7800 m (0.37 0.63) *   3) guy>=0.5 9409  2400 m (0.25 0.75) *> > #test the model by calculating a confusion matrix> pred <- predict(tree, newdata= test, type="class")> > table(pred,test$Label)    pred    f    m   f 2877 2073   m 4358 8675> > #plot the tree> #rpart.plot(tree, box.palette="RdBu", shadow.col="gray", nn=TRUE)> > # clear some space> gc()          used  (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)Ncells 3.6e+06   192    6.6e+06   353         NA  6.6e+06   353Vcells 2.4e+09 18567    4.8e+09 36662      1e+05  4.3e+09 33067> rm(train)> rm(test)> > # The use of Term Frequency-Inverse Document Frequency (TF-IDF) is a > # powerful technique for enhancing the information/signal contained> # within our document-frequency matrix. Specifically, the mathematics> # behind TF-IDF accomplish the following goals:> #    1 - The TF calculation accounts for the fact that longer > #        documents will have higher individual term counts. Applying> #        TF normalizes all documents in the corpus to be length > #        independent.> #    2 - The IDF calculation accounts for the frequency of term> #        appearance in all documents in the corpus. The intuition > #        being that a term that appears in every document has no> #        predictive power.> #    3 - The multiplication of TF by IDF for each cell in the matrix> #        allows for weighting of #1 and #2 for each cell in the matrix.> > > # Our function for calculating relative term frequency (TF)> term.frequency <- function(row) {+   row / sum(row)+ }> > # Our function for calculating inverse document frequency (IDF)> inverse.doc.freq <- function(col) {+   corpus.size <- length(col)+   doc.count <- length(which(col > 0))+   +   log10(corpus.size / doc.count)+ }> > # Our function for calculating TF-IDF.> tf.idf <- function(x, idf) {+   x * idf+ }> > > # First step, normalize all documents via TF.> all.tokens.df1 <- apply(all.tokens.matrix, 1, term.frequency)> dim(all.tokens.df1)[1] 12857 59946> View(all.tokens.df1[1:20, 1:100])> > # Second step, calculate the IDF vector that we will use - both> # for training data and for test data!> all.tokens.idf <- apply(all.tokens.matrix, 2, inverse.doc.freq)> str(all.tokens.idf) Named num [1:12857] 0.35 0.589 1.362 0.9 1.048 ... - attr(*, "names")= chr [1:12857] "think" "kind" "intellectu" "either" ...> > > # Lastly, calculate TF-IDF for our training corpus.> all.tokens.tfidf <-  apply(all.tokens.df1, 2, tf.idf, idf = all.tokens.idf)> dim(all.tokens.tfidf)[1] 12857 59946> View(all.tokens.tfidf[1:25, 1:25])> save(file='Week5_datingNLP.rdata', tree, all.tokens.tfidf)
> rm(all.tokens.df1)> rm(all.tokens.idf)> rm(all.tokens.tfidf)> > > # Remove the batch effect: find and eliminate “male words” and “female words”> > male.words <- subset(essays, profiles$sex == "m") %>%+   str_split(" ") %>%+   unlist() %>%+   table() %>%+   sort(decreasing=TRUE) %>%+   names()> > female.words <- subset(essays, profiles$sex == "f") %>%+   str_split(" ") %>%+   unlist() %>%+   table() %>%+   sort(decreasing=TRUE) %>%+   names()> > # Top 25 male words:> print( male.words[1:25] ) [1] ""       "not"    "me"     "."      "good"   "out"    "-"      "about"  "just"   "all"    "what"   "people" "this"  [14] "'s"     "from"   ","      "new"    "some"   "don't"  "really" "up"     "get"    "time"   "also"   "how"   > # Top 25 female words> print( female.words[1:25] ) [1] ""        "me"      "not"     "good"    "."       "out"     "-"       "about"   "all"     "just"    "people" [12] "what"    "new"     "don't"   "who"     "'s"      "this"    ","       "friends" "time"    "really"  "from"   [23] "up"      "also"    "("      > > # Words in the males top 500 that weren't in the females' top 500:> male_words<-as.data.frame(setdiff(male.words[1:500], female.words[1:500]))> # Words in the female top 500 that weren't in the males' top 500:> female_words<-as.data.frame(setdiff(female.words[1:500], male.words[1:500]))> > > #remove the male/female words from the df> all.tokens.df<-all.tokens.df[,!names(all.tokens.df)%in% male_words]> > all.tokens.df<-all.tokens.df[,!names(all.tokens.df)%in% female_words]> > # clear some memory> rm(male_words)> rm(female_words)> rm(male.words)> rm(female.words)> > #remove the labels and non numeric features> all.tokens.df.sub<-all.tokens.df[,-c(1,2)]